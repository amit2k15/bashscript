#!/bin/bash

# Function to monitor SFTP authentication
function monitor_sftp_auth {
    host="$1"
    port="$2"
    user="$3"
    password="$4"

    # Run SFTP command using expect to automate the authentication
    expect -c "
        spawn sftp -oPort=$port $user@$host
        expect {
            \"Are you sure you want to continue connecting\" {
                send \"yes\r\"
                exp_continue
            }
            \"password:\" {
                send \"$password\r\"
                exp_continue
            }
            \"sftp>\" {
                send \"exit\r\"
            }
        }
        interact
    "
}

# Check if expect is installed
if ! command -v expect &>/dev/null; then
    echo "Error: expect is not installed. Please install expect to use this script."
    exit 1
fi

# Get input from the user
read -p "Enter SFTP host: " host
read -p "Enter SFTP port: " port
read -p "Enter SFTP user: " user
read -s -p "Enter SFTP password: " password
echo # Newline after password input

# Call the function with provided input
monitor_sftp_auth "$host" "$port" "$user" "$password"
