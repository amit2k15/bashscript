#!/bin/bash

# Function to monitor SFTP authentication
function monitor_sftp_authentication() {
    local host="$1"
    local port="$2"
    local user="$3"
    local password="$4"

    # Set the SFTP command
    local sftp_cmd="sftp -P $port $user@$host"

    # Execute sftp command using sshpass and redirect 'yes' to answer any prompt
    # and provide the password when prompted for it
    sshpass -p "$password" yes | $sftp_cmd
    local exit_code="$?"

    # Check the exit code to determine success or failure
    if [ "$exit_code" -eq 0 ]; then
        echo "SFTP authentication successful."
    else
        echo "SFTP authentication failed."
    fi
}

# Check if all required arguments are provided
if [ "$#" -ne 4 ]; then
    echo "Usage: $0 <host> <port> <user> <password>"
    exit 1
fi

# Call the function with provided arguments
monitor_sftp_authentication "$1" "$2" "$3" "$4"
